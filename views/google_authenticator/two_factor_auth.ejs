<% layout('layout') %>

<h1><%= title %></h1>

<p>
  Refer: https://github.com/speakeasyjs/speakeasy<br>
  Refer: https://davidwalsh.name/2fa
</p>

<div class="row">
  <div class="col-sm-12">
    <h2>Login</h2>

    <% if (data.user) { %>
    <label>Logged in by <%= data.user.email %></label>

    <% } else { %>
    <form method="post" action="/google-authenticator/login">
      <div class="form-group">
        <label>Email:</label>
        <input type="text" name="email" value="">
      </div>

      <div class="form-group">
        <label>Password:</label>
        <input type="password" name="password" value="">
      </div>

      <button type="submit" class="btn btn-info">Login</button>
    </form>
    <% } %>
  </div>
</div>

<div class="row">
  <div class="col-sm-12">
    <h2>Read QR Code by Google Authenticator</h2>

    <% if (data.dataUrl) { %>
    <img src="<%= data.dataUrl %>">
    <% }%>
  </div>
</div>

<div class="row">
  <div class="col-sm-12">
    <h2>Verify by Token</h2>

    <% if (data.dataUrl && data.token) { %>
    <form method="post" action="/google-authenticator/verify">
      <div class="form-group">
        <label>JWT Token:</label>
        <input type="text" name="token" value="<%= data.token %>">
      </div>

      <div class="form-group">
        <label>User Token:</label>
        <input type="text" name="user_token" value="">
      </div>

      <button type="submit" class="btn btn-info">Verify</button>
    </form>
    <% } %>

    <% if (data.verified) { %>
    <label>Verified</label>
    <% } %>
  </div>
</div>

